<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>vNugglets.Utility by vNugglets</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">vNugglets.Utility</h1>
      <h2 class="project-tagline">A PowerShell module with nearly all of the vNugglets goodness from over the years, all in one place!</h2>
      <a href="https://github.com/vNugglets/vNuggletsPSMod" class="btn">View on GitHub</a>
      <a href="https://github.com/vNugglets/vNuggletsPSMod/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/vNugglets/vNuggletsPSMod/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h2>
<a id="vnuggletsutility-powershell-module" class="anchor" href="#vnuggletsutility-powershell-module" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>vNugglets.Utility PowerShell module</h2>

<p>Some examples and their sample output (see each cmdlet's help for more examples):</p>

<h3>
<a id="connect-vnviserver-connects-to-the-given-vcenters-update-windows-title-bar" class="anchor" href="#connect-vnviserver-connects-to-the-given-vcenters-update-windows-title-bar" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>Connect-VNVIServer</code>: Connects to the given vCenters, update window's title bar</h3>

<pre><code>    C:\PS&gt; Connect-VNVIServer -Credential $myCred -Server myVC0.dom.com, myVC1.dom.com
    Name                 Port  User
    ----                 ----  ----
    myVC0.dom.com        443   DOM\USER0
    myVC1.dom.com        443   DOM\USER0
</code></pre>

<h3>
<a id="copy-vnvirole-copy-viroles-from-here-to-there" class="anchor" href="#copy-vnvirole-copy-viroles-from-here-to-there" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>Copy-VNVIRole</code>: Copy VIRoles from here to there</h3>

<p>Copy the VIRole "SysAdm" from the given source vCenter to a new VIRole named "SysAdm_copyTest" in the given destination vCenter</p>

<pre><code>    C:\PS&gt; Copy-VNVIRole -SourceRoleName SysAdm -DestinationRoleName SysAdm_copyTest -SourceVCName `
    &gt;&gt; vcenter.dom.com -DestinationVCName othervcenter.dom.com
    Name                 IsSystem
    ----                 --------
    SysAdm_copyTest      False
</code></pre>

<p>Copy the given VIRole from the given source vCenter to a new VIRole named "SysAdm_copyTest" in the <em>same</em> vCenter</p>

<pre><code>    C:\PS&gt; Copy-VNVIRole -SourceRoleName MyTestRole0 -DestinationRoleName SomeRole_copyTest `
    &gt;&gt; -SourceVCName vcenter.dom.com -DestinationVCName vcenter.dom.com
    Name                 IsSystem
    ----                 --------
    SomeRole_copyTest    False
</code></pre>

<h3>
<a id="get-vnnetworkclusterinfo-get-vmware-ha-cluster-info-for-a-virtual-network" class="anchor" href="#get-vnnetworkclusterinfo-get-vmware-ha-cluster-info-for-a-virtual-network" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>Get-VNNetworkClusterInfo</code>: Get VMware HA Cluster info for a virtual network</h3>

<p>Gets information about virtual networks whose names match the (very simple) regular expressions, "101" and "121"</p>

<pre><code>    C:\PS&gt; Get-VNNetworkClusterInfo -Name 101,234
    Name           ClusterName  ClusterId      Type                                    MoRef
    ----           -----------  ---------      ----                                    -----
    my.Portgrp101  myCluster0   ClusterCom...  VMware.Vim.Network                      Network-ne...
    my.Portgrp234  myCluster20  ClusterCom...  VMware.Vim.DistributedVirtualPortgroup  Network-ne...
</code></pre>

<p>Gets information about virtual networks whose names are literally "my.Portgroup0" (not matching "my.Portgroup01"or "test_myXPortgroup0" -- just a literal match only) </p>

<pre><code>    C:\PS&gt; Get-VNNetworkClusterInfo -LiteralName my.Portgroup0 | ft -a
    Name           ClusterName  ClusterId                          Type                MoRef
    ----           -----------  ---------                          ----                -----
    my.Portgroup0  myCluster0   ClusterComputeResource-domain-c94  VMware.Vim.Network  Network-ne...
</code></pre>

<h3>
<a id="get-vnuplinknicforvm-get-the-vmnic-uplink-used-by-vms-on-given-vmhost" class="anchor" href="#get-vnuplinknicforvm-get-the-vmnic-uplink-used-by-vms-on-given-vmhost" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>Get-VNUplinkNicForVM</code>: Get the vmnic uplink used by VMs on given VMHost</h3>

<p>Gets the Netports on given VMHost, and returns their client name, uplink vmnic, vSwitch, etc.</p>

<pre><code>    C:\PS&gt; Get-VNUplinkNicForVM -VMHost myhost0.dom.com -Credential (Get-Credential root)
    ClientName           TeamUplink          vSwitch           VMHost
    ----------           ----------          -------           ---------------
    Management           n/a                 vSwitch0          myhost0.dom.com
    vmk1                 vmnic0              vSwitch0          myhost0.dom.com
    vmk0                 vmnic0              vSwitch0          myhost0.dom.com
    myvm001              vmnic0              vSwitch0          myhost0.dom.com
    myvm002              vmnic3              vSwitch1          myhost0.dom.com
    myvm003              vmnic5              vSwitch2          myhost0.dom.com
    myvm050.eth0         vmnic4              DvsPortset-0      myhost0.dom.com
    ...
</code></pre>

<h3>
<a id="get-vnvmbyaddress-get-vms-by-various-addresses" class="anchor" href="#get-vnvmbyaddress-get-vms-by-various-addresses" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>Get-VNVMByAddress</code>: Get VMs by various addresses</h3>

<p>Get VMs with given MAC address, return VM name and its MAC addresses</p>

<pre><code>    C:\PS&gt; Get-VNVMByAddress -MAC 00:50:56:b0:00:01
    Name     MacAddress                              MoRef
    ------   ------------                            -----
    myvm0    {00:50:56:b0:00:01,00:50:56:b0:00:18}   VirtualMachine-vm-2155
</code></pre>

<p>Get VMs with given IP as reported by VMware Tools, return VM name and its IP addresses</p>

<pre><code>    C:\PS&gt; Get-VNVMByAddress -IP 10.37.31.12
    Name     IP                                         MoRef
    ------   ---                                        -----
    myvm10   {192.16.13.1, 10.37.31.12, fe80::000...}   VirtualMachine-vm-13
</code></pre>

<p>Use <code>-AddressWildcard</code> to find VMs with approximate IP</p>

<pre><code>    C:\PS&gt; Get-VNVMByAddress -AddressWildcard 10.0.0.*
    Name           IP                                      MoRef
    ----           --                                      -----
    myvm3          {10.0.0.20, fe80::000:5600:fe00:6007}   VirtualMachine-vm-153
    mytestVM001    10.0.0.200                              VirtualMachine-vm-162
</code></pre>

<h3>
<a id="get-vnvmbyrdm-get-vms-by-rdm" class="anchor" href="#get-vnvmbyrdm-get-vms-by-rdm" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>Get-VNVMByRDM</code>: Get VMs by RDM</h3>

<p>Find VM using the given LUN as an RDM, returning an object with the information about that RDM harddisk on the VM</p>

<pre><code>    C:\PS&gt; Get-VNVMByRDM -CanonicalName naa.60000112233445501000000000000001 -Cluster someCluster
    VMName            : myvm002
    HardDiskName      : Hard disk 7
    CompatibilityMode : physicalMode
    CanonicalName     : naa.60000112233445501000000000000001
    DeviceDisplayName : myvm002-logs
    MoRef             : VirtualMachine-vm-174
</code></pre>

<p>Find VMs using the given LUN as an RDM, formatting output in auto-sized table with just the given properties</p>

<pre><code>    C:\PS&gt; Get-VNVMByRDM -CanonicalName naa.60000112233445501000000000000002 -Cluster someCluster | `
    &gt;&gt; ft -a VMName, HardDiskName, DeviceDisplayName, CanonicalName
    VMName    HardDiskName  DeviceDisplayName   CanonicalName
    ------    ----------    -----------------   -------------
    myvm0050  Hard disk 10  myMSCluster-quorum  naa.60000112233445501000000000000002
    myvm0051  Hard disk 10  myMSCluster-quorum  naa.60000112233445501000000000000002
</code></pre>

<h3>
<a id="get-vnvmbyvirtualportgroup-get-vms-by-virtual-portgroup" class="anchor" href="#get-vnvmbyvirtualportgroup-get-vms-by-virtual-portgroup" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>Get-VNVMByVirtualPortGroup</code>: Get VMs by virtual portgroup</h3>

<p>Get networks matching "VLAN19", and get their VMs' names and some other VM information</p>

<pre><code>    C:\PS&gt; Get-VNVMByVirtualPortGroup -NetworkName VLAN19 | ft VMName,Network,VMHost,Cluster
    VMName          Network         VMHost            Cluster
    ------          -----------     ------            -------
    vm0.dom.com     VLAN19.Sekurr   vmhost0.dom.com   myCluster0
    vm10.dom.com    VLAN19.Sekurr   vmhost3.dom.com   myCluster0
    vm32.dom.com    VLAN19.Sekurr   vmhost2.dom.com   myCluster0
    ...
</code></pre>

<p>Get network named exactly "VLAN3", and get its VMs' names and some other VM information</p>

<pre><code>    C:\PS&gt; Get-VNVMByVirtualPortGroup -NetworkLiteralName VLAN3 | ft -a
    VMName   Network  VMHost            Cluster     PowerState   MoRef
    ------   -------  ------            -------     ----------   -----
    myVM0    VLAN3    myVMHost.dom.com  myCluster2  poweredOn    VirtualMachine-vm-142
    ...
</code></pre>

<h3>
<a id="get-vnvmdiskandrdm-get-the-disks-including-rdms-for-vms" class="anchor" href="#get-vnvmdiskandrdm-get-the-disks-including-rdms-for-vms" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>Get-VNVMDiskAndRDM</code>: Get the disks (including RDMs) for VMs</h3>

<p>Get the disks (including RDMs) for "someVM". Note, the ScsiCanonicalName property is only valid (and only populated for) RDM disks</p>

<pre><code>    C:\PS&gt; Get-VM someVM | Get-VNVMDiskAndRDM
    VMName            : someVM
    HardDiskName      : Hard disk 1
    ScsiId            : 0:0
    DeviceDisplayName :
    SizeGB            : 50
    ScsiCanonicalName :

    VMName            : someVM
    HardDiskName      : Hard disk 2
    ScsiId            : 1:0
    DeviceDisplayName : someVM-/log_dir
    SizeGB            : 20
    ScsiCanonicalName : naa.60000111111115615641111111111111
</code></pre>

<p>Get the disks (including RDMs) for VMs matching the name regular expression pattern "someVM", formatting output in auto-sized table. Note, the ScsiCanonicalName property is only valid (and only populated for) RDM disks</p>

<pre><code>    C:\PS&gt;Get-VNVMDiskAndRDM -VMName someVM | ft -a
    VMName   HardDiskName ScsiId DeviceDisplayName SizeGB ScsiCanonicalName
    ------   ------------ ------ ----------------- ------ -----------------
    someVM0  Hard disk 1  0:0                          50
    someVM0  Hard disk 2  1:0    someVM0-/log_dir      20 naa.60000111111115615641111111111111
    someVM1  Hard disk 1  0:0                         180
    someVM1  Hard disk 2  1:0    someVM1-/log_dir     120 naa.60000111111115615641111111111112
</code></pre>

<h3>
<a id="get-vnvmevcinfo-get-vm-evc-configuration-information-for-vms-with-different-evc-mode-than-the-cluster" class="anchor" href="#get-vnvmevcinfo-get-vm-evc-configuration-information-for-vms-with-different-evc-mode-than-the-cluster" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>Get-VNVMEVCInfo</code>: Get VM EVC configuration information for VMs with different EVC mode than the cluster</h3>

<pre><code>    C:\PS&gt; Get-VNVMEVCInfo -Cluster myCluster | Where-Object {$_.VMEVCMode -ne $_.ClusterEVCMode}
    Name        PowerState   VMEVCMode   ClusterEVCMode   ClusterName
    ----        ----------   ---------   --------------   -----------
    myvm001     poweredOff               intel-nehalem    myCluster0
    myvm100     poweredOff               intel-nehalem    myCluster0
</code></pre>

<h3>
<a id="get-vnvmhostbrokenuplink-get-information-for-all-vmhosts-vsswitches-uplinks-ones-used-as-uplinks-but-with-no-apparent-link" class="anchor" href="#get-vnvmhostbrokenuplink-get-information-for-all-vmhosts-vsswitches-uplinks-ones-used-as-uplinks-but-with-no-apparent-link" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>Get-VNVMHostBrokenUplink</code>: Get information for all VMHost's vSSwitches' uplinks (ones used as uplinks, but with no apparent link)</h3>

<pre><code>    C:\PS&gt; Get-VNVMHostBrokenUplink
    VMHost            vSwitch   BustedVmnic  BitRatePerSec
    ------            -------   -----------  -------------
    myhost03.dom.com  vSwitch0  vmnic1                   0
    myhost22.dom.com  vSwitch5  vmnic7                   0
    myhost24.dom.com  vSwitch1  vmnic3                   0
</code></pre>

<h3>
<a id="get-vnvmhostfirmwareinfo-get-some-hp-vmhosts-firmware-information" class="anchor" href="#get-vnvmhostfirmwareinfo-get-some-hp-vmhosts-firmware-information" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>Get-VNVMHostFirmwareInfo</code>: Get some HP VMHosts' firmware information</h3>

<pre><code>    C:\PS&gt; Get-VMHost myhost01.dom.com,myhost02.dom.com | Get-VNVMHostFirmwareInfo
    VMHostName   : myhost01.dom.com
    SystemBIOS   : HP System BIOS P65 2015-08-16 00:00:00.000
    HPSmartArray : HP Smart Array Controller HPSA1 Firmware 6.64
    iLOFirmware  : Hewlett-Packard BMC Firmware (node 0) 46:10000 1.88
    Model        : ProLiant DL580 G7

    VMHostName   : myhost02.dom.com
    SystemBIOS   : HP System BIOS P65 2015-08-16 00:00:00.000
    HPSmartArray : HP Smart Array Controller HPSA1 Firmware 6.64
    iLOFirmware  : Hewlett-Packard BMC Firmware (node 0) 46:10000 1.88
    Model        : ProLiant DL580 G7
</code></pre>

<h3>
<a id="get-vnvmhosthbawwn-get-vmhost-hba-wwns-on-the-quick" class="anchor" href="#get-vnvmhosthbawwn-get-vmhost-hba-wwns-on-the-quick" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>Get-VNVMHostHBAWWN</code>: Get VMHost HBA WWNs on the quick</h3>

<pre><code>    C:\PS&gt; Get-VMHost myVMHost.dom.com | Get-VMHostHBAWWN
    VMHostName        DeviceName  HBAPortWWN               HBANodeWWN               HBAStatus
    ----------        ----------  ----------               ----------               ---------
    myVMHost.dom.com  vmhba2      10:00:00:00:aa:bb:cc:53  20:00:00:00:aa:bb:cc:53  online
    myVMHost.dom.com  vmhba3      10:00:00:00:aa:bb:cc:86  20:00:00:00:aa:bb:cc:86  online
</code></pre>

<h3>
<a id="get-vnvmhostlogicalvolumeinfo--get-vmhosts-logical-volume-information" class="anchor" href="#get-vnvmhostlogicalvolumeinfo--get-vmhosts-logical-volume-information" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>Get-VNVMHostLogicalVolumeInfo</code>:  Get VMHosts' logical volume information</h3>

<pre><code>    C:\PS&gt;Get-Cluster myCluster0 | Get-VMHost | Get-VNVMHostLogicalVolumeInfo
    VMHostName          LogicalVolume
    ----------          -------------
    myhost20.dom.com    Logical Volume 1 on HPSA1 : RAID 1 : 136GB : Disk 1,2
    myhost21.dom.com    Logical Volume 1 on HPSA1 : RAID 1 : 136GB : Disk 1,2
    myhost22.dom.com    Logical Volume 1 on HPSA1 : RAID 1 : 279GB : Disk 1,2,3
</code></pre>

<h3>
<a id="get-vnvmhostnicfirmwareanddriverinfo-grab-nic-driver--and-firmware-versions-for-nics-on-vmhosts" class="anchor" href="#get-vnvmhostnicfirmwareanddriverinfo-grab-nic-driver--and-firmware-versions-for-nics-on-vmhosts" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>Get-VNVMHostNICFirmwareAndDriverInfo</code>: Grab NIC driver- and firmware version(s) for NICs on VMHosts</h3>

<pre><code>C:\PS&gt;Get-Cluster myCluster0 | Get-VMHost | Get-VNVMHostNICFirmwareAndDriverInfo | sort VMHostName
VMHostName         NicDriverVersion        NicFirmwareVersion
----------         ----------------        ------------------
myhost0.dom.com    nx_nic driver 5.0.619   nx_nic device firmware 4.0.588
myhost1.dom.com    nx_nic driver 5.0.619   nx_nic device firmware 4.0.588
myhost2.dom.com    nx_nic driver 5.0.619   nx_nic device firmware 4.0.588
...
</code></pre>

<h3>
<a id="other-cmdlets-in-module-for-which-sample-output-not-provided-here" class="anchor" href="#other-cmdlets-in-module-for-which-sample-output-not-provided-here" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Other cmdlets in module, for which sample output not provided here:</h3>

<ul>
<li><code>Invoke-VNEvacuateDatastore</code></li>
<li><code>Move-VNTemplateFromVMHost</code></li>
<li><code>Update-VNTitleBarForPowerCL</code></li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/vNugglets/vNuggletsPSMod">vNugglets.Utility</a> is maintained by <a href="https://github.com/vNugglets">vNugglets</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
